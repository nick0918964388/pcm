# 工程關鍵指標平台 (PCM) - 前端開發規格書

**文件版本:** 1.0
**日期:** 2025年8月29日
**核心技術棧:** Next.js, Tailwind CSS

---

## 第一部分：頁面與功能需求 (Pages & Functionality)

本節詳細說明了應用程式所需的所有頁面及其核心功能，完整涵蓋了 `pcm1.jpg` 至 `pcm5.png` 的所有介面內容。

### 1.1 核心應用頁面

* **登入頁面 (Login Page):**
    * **功能:** 提供使用者名稱與密碼輸入框，進行身份驗證。包含「記住我」及「忘記密碼」的連結。

* **專案主頁/選擇頁 (Project Hub / Selection Page):**
    * **功能:** 使用者登入後的第一個頁面，用於導航至其有權限的專案。
    * **參考:** `pcm1.jpg`
    * **介面元素:**
        * 左側顯示專案列表 (如 F20P1, F22P4)。
        * 主區域顯示選定專案的關鍵資訊（如里程碑）。
        * 底部為專案形象圖片輪播。

* **單一專案儀表板 (Detailed Project Dashboard):**
    * **功能:** 特定專案的核心頁面，以視覺化方式呈現所有關鍵指標和即時資訊。
    * **參考:** `pcm2.jpg`, `pcm3.jpg`
    * **介面元素:**
        * **KPI 總覽卡片:** 專案啟始/完工日、專案天數、設備到案數等。
        * **進度圖表:** 專案進度百分比、驗收比例、付款比例。
        * **每日數據:** 今日出工、最高出工、送審文件狀態、品質稽核狀態等。
        * **視覺化圖表:** KPI 長條圖，用於比較不同子項目的表現。
        * **資訊列表:** 「工地 ESH 要點」和「最新消息」的即時列表。

### 1.2 導覽列功能模組

以下為應用程式主導覽列及其對應的所有功能頁面。

* **專案範疇 (Project Scope)**
    * **專案成員查詢:** 查詢專案團隊的成員、角色與聯絡方式。
    * **WBS 項目設定:** 工作分解結構 (WBS) 的建立、編輯與管理介面。

* **人力資源 (Human Resources)**
    * **廠商人員通訊錄:** 顯示所有合作廠商人員的詳細聯絡資訊列表，具備強大的搜尋與篩選功能 (`pcm4.png`)。
    * **出工人數統計 (刷卡機):** 分析來自刷卡機的出工數據，提供日報、週報、月報及趨勢圖 (`pcm5.png`)。
    * **出工人數統計 (PowerBI):** 嵌入或連結至 PowerBI 報表，提供互動式數據分析。
    * **刷卡歷史紀錄查詢:** 可依據人員、日期區間查詢詳細的個人刷卡進出紀錄。
    * **廠商未刷卡通知:** 系統化管理應出工但無刷卡紀錄的人員，並可產生通知。

* **時程管理 (Schedule Management)**
    * **專案里程碑 (Milestone):** 以甘特圖或時間軸形式顯示重要的專案里程碑及其達成狀態。
    * **發包狀況 (Package Status):** 追蹤各工程發包項目的進度、合約狀態與關鍵日期。
    * **法規許可證管理 (Permit Management):** 集中管理所有必要的法規許可證申請進度與文件。
    * **連動歷史工期比對:** 提供比對當前時程與歷史基準線的功能，以分析延遲或提前。

* **成本管理 (Cost Management)**
    * **成本管控:** 儀表板，用於追蹤預算、實際支出、估算成本，並進行差異分析。
    * **發包文件:** 管理所有工程發包相關的合約、報價單等文件。
    * **DCR 管理 (Design Change Request):** 設計變更請求的提報、審批流程、成本影響分析與執行追蹤。

* **品質管理 (Quality Management)**
    * **品質日報/週報:** 線上填寫、提交與查閱每日或每週的品質管理報告。
    * **品質稽核:** 記錄、追蹤和管理品質稽核活動，包含缺失項改善追蹤。
    * **品質 KPI:** 專門顯示品質相關指標的儀表板，如檢驗合格率、缺失項數量等。
    * **品質稽核彙總表:** 提供所有品質稽核項目的總覽與統計報告。

* **溝通管理 (Communication Management)**
    * **最新消息:** 專案公告、重要通知的發布與瀏覽平台。
    * **文件管理 (IDC):** 專案的中央文件庫，支援版本控制、權限管理與線上預覽。
    * **會議室預約系統:** 提供線上預約、管理會議室使用排程的功能。
    * **iPhoto 2.0 (工程照片庫):** 一個用於上傳、分類和瀏覽工地照片的系統。

* **風險與工安環保 (Risk, Safety & Environmental)**
    * **ESH 管理平台:** 工安環保 (ESH) 工作的核心平台，包含風險評估、巡檢記錄、事件報告等。
    * **ESH 週/日報:** 線上提交與查閱工安環保的定期報告。
    * **環保 GPS 即時監控:** 在地圖上即時顯示特定機具或車輛的位置與軌跡。
    * **環保數值即時監測:** 顯示環境監測設備（如噪音、空氣品質）的即時數據儀表板。

* **即時影像 (Real-time Video)**
    * **工地即時影像:** 整合並顯示來自工地各區域的即時攝影機畫面。

---

## 第二部分：使用者角色與權限 (User Roles & Permissions)

* **管理員 (Admin):**
    * **權限:** 擁有系統所有權限。可新增/管理專案、設定使用者帳號與角色、存取所有專案的數據。

* **專案經理 (Project Manager):**
    * **權限:** 擁有其負責專案的完整讀寫權限。可更新時程、成本、審批文件、管理團隊成員。

* **團隊成員/工程師 (Team Member/Engineer):**
    * **權限:** 主要為讀取權限，可查看其所在專案的各項數據。根據職責可能擁有特定模組的寫入權限（如上傳品質報告、填寫日報）。

* **廠商/承包商 (Vendor/Contractor):**
    * **權限:** 嚴格限制的存取權限。僅能查看與自身合約相關的資訊，如自家員工的出勤紀錄、負責的發包項目、需回覆的送審文件等。

---

## 第三部分：共用元件與 UI/UX (Shared Components & UI/UX)

* **導覽系統 (Navigation System):** 採用固定的頂部導覽列，滑鼠懸停在主選單項目時，以動畫效果流暢地顯示下拉式選單。
* **頁首 (Header):** 包含系統 Logo、當前登入使用者資訊、登出按鈕、語言切換及幫助連結。
* **麵包屑 (Breadcrumbs):** 在每個頁面的內容區頂部顯示，清晰標示使用者當前位置，提供快速返回上層的路徑。
* **核心可複用元件庫:**
    * `DataTable`: 具備排序、客戶端/伺服器端篩選、分頁功能的數據表格。
    * `DashboardWidget`: 用於儀表板上的 KPI 數據卡片，風格統一。
    * `FilterBar`: 一個可配置的篩選器元件，用於列表頁面。
    * `ChartComponent`: 封裝 `Chart.js` 或 `Recharts`，用於繪製長條圖、趨勢圖。
    * `Modal`: 統一風格的彈出視窗元件，用於表單填寫、確認對話框、內容預覽。
    * `Button`, `Input`, `Select`, `DatePicker`: 基礎表單元件，確保應用程式內風格一致。

---

## 第四部分：技術規格與架構 (Technical Specifications & Architecture)

* **前端框架:** Next.js (使用 App Router 以實現現代化的路由與佈局)。
* **樣式方案:** Tailwind CSS (採用 Utility-First 的方法進行快速、響應式的 UI 開發)。
* **狀態管理:** Zustand 或 Jotai (輕量級、易於使用的全域狀態管理方案)。
* **數據請求:** 使用 custom hooks (`useSWR` 或 `React Query`) 搭配 `fetch` 或 `axios` 進行 API 請求，以處理快取、重新驗證和錯誤處理。
* **圖表函式庫:** Chart.js 或 Recharts。
* **日期處理:** `date-fns` 或 `day.js`。
* **模擬 API (Mock API):** 在開發初期，使用 Mock Service Worker (MSW) 建立一個與後端規格一致的模擬 API，確保前端可以獨立開發與測試。數據結構應包含 ID、關聯性等，以模擬真實資料庫。
* **身份驗證:** 採用 JWT (JSON Web Token) 流程。登入後將 token 儲存在安全的 `httpOnly` cookie 中，並在每次 API 請求時攜帶。實作路由守衛 (Middleware) 保護需要登入才能存取的頁面。
* **專案結構:**
    ```plaintext
    /src
    ├── /app                 # Next.js App Router 路由與頁面
    ├── /components          # 可複用 UI 元件
    │   ├── /ui              # 基礎元件 (Button, Input)
    │   └── /shared          # 複合元件 (DataTable, FilterBar)
    ├── /services            # API 請求邏輯
    ├── /hooks               # 自定義 Hooks
    ├── /lib                 # 共用函式、工具
    ├── /store               # 狀態管理 (Zustand)
    └── /mocks               # MSW 模擬 API
    ```

---

## 第五部分：額外考量與最佳實踐 (Additional Considerations)

* **響應式設計 (RWD):** 所有頁面和元件必須在桌面、平板和行動裝置上都有良好的顯示和操作體驗。
* **效能優化:** 利用 Next.js 的伺服器元件 (Server Components)、代碼分割 (Code Splitting) 和圖片優化 (`next/image`) 來確保快速的頁面載入速度。
* **可維護性:** 撰寫清晰、有註解的程式碼。遵循一致的命名規範和程式碼風格 (可使用 ESLint 和 Prettier 強制執行)。
* **無障礙設計 (Accessibility):** 確保 UI 元件符合 WCAG 標準，例如為表單元素提供標籤、確保足夠的色彩對比度等。